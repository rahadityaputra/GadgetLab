<!DOCTYPE html>
<html lang="en">
  <%- include('includes/header') %>
  
  <body class="d-flex flex-column min-vh-100 text-light">
    
    <%- include('includes/navbar', {user}) %>

    <div class="container my-5">
        <div class="row">
          <div class="col-md-6">
            <h2 class="fw-semibold text-center"><%= phone.name %></h2>
            <div class="d-flex justify-content-center">
              <img src="<%= phone.img %>" class="img-fluid rounded-4 mb-1" alt="Phone Image">
            </div>            
            <p><strong>Price:</strong> $999.99</p> <!-- ganti dengan harga dari API jika tersedia -->
            <strong>Specifications:</strong>
            <table class="table table-bordered table-hover">
              <% phone.detailSpec.forEach(category => { %>
                <tr>
                  <th rowspan="<%= category.specifications.length %>"><%= category.category %></th>
                  <% category.specifications.forEach((spec, index) => { %>
                    <% if (index > 0) { %> 
                      <tr>
                    <% } %>
                    <td><%= spec.name %></td>
                    <td><%= spec.value %></td>
                    </tr>
                  <% }) %>
              <% }) %>

            </table>
            <p class="text-light">Deskripsi singkat HPnya mungkin</p> <!-- Deskripsi jika tersedia dari API -->
      
            <!-- Favorite Button -->
            <button class="btn btn-danger" id="favorite">
              <i class="bi bi-heart"></i> Add to Favorites
            </button>
      
            <!-- Phone Rating (Stars) -->
            <div class="mt-3">
              <span class="text-warning">
                <i class="bi bi-star-fill"></i>
                <i class="bi bi-star-fill"></i>
                <i class="bi bi-star-fill"></i>
                <i class="bi bi-star-fill"></i>
                <i class="bi bi-star-half"></i>
              </span> 
              <span class="ms-2">4.5/5</span>
            </div>
          </div>
      
          <!-- User Reviews -->
          
          <div class="col-md-6">
            <h3>User Reviews</h3>     
            <% if(reviews) {%>       
              <% reviews.forEach(function ({dataValues}) { %>
              <div class="mb-4">
                <div class="d-flex justify-content-between">
                  <span><strong><%= dataValues.User.dataValues.username %></strong></span>
                  <span class="text-light"><%= dataValues.review_date %></span> <!-- Bisa diganti dengan tanggal dari API -->
                </div>
                <div class="text-light">
                  <%= dataValues.review_text %>
                </div>
                <div class="mt-2">
                  <span class="text-warning">
                    <% for (let i = 0; i < dataValues.rating; i++) { %>
                      <i class="bi bi-star-fill"></i>
                   <% } %>
                    <% for (let i = 0; i < 5 - dataValues.rating; i++) { %>
                      <i class="bi bi-star-empty"></i>
                   <% } %>
                  </span> 
                </div>
              </div>
              <% }) %>
            <% } else {%>       
              <!-- kata kata terserah gmn , jika komen tidak ada -->

            <% } %>       
            </div>


        </div>
        <!-- Add Your Own Review -->
         <div class="row mt-5">
        <h4>Write Your Own Review</h4>
        <form id="review">
          <% if(user) { %>
            <input type="number" hidden value="<%= user.id %>" id="idUser">
          <% } %>
          <input type="text" hidden value="<%= phone.id %>" id="idDevice">
          <div class="mb-3">
            <label for="reviewText" class="form-label">Your Review</label>
            <textarea class="form-control" id="reviewText" rows="4"></textarea>
          </div>
          <div class="mb-3">
            <label for="reviewRating" class="form-label">Rating</label>
            <select class="form-select w-25" id="reviewRating">
              <option value="5">5 Stars</option>
              <option value="4">4 Stars</option>
              <option value="3">3 Stars</option>
              <option value="2">2 Stars</option>
              <option value="1">1 Star</option>
            </select>
          </div>
          <input type="submit" class="btn btn-primary" value="Submit Review"></input>
        </form>
      </div>
      </div>
    
      <%- include('includes/footer') %>


      <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
      <script src="/phone.js"></script>
    </body>
</html>
